<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Diagnosing the identification of the model — diagnose_identification • pimbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnosing the identification of the model — diagnose_identification"><meta property="og:description" content="Estimate parameters using small posterior samples from JAGS,
calculate the approximate Fisher information matrix
and return the condition number and rank of the approximate Fisher information matrix
with asymptotic variances of estimated parameters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pimbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Diagnosing-identification.html">Diagnosing the identification of the model</a>
    </li>
    <li>
      <a href="../articles/Sampling-cross-manual.html">Sampling with ISTP manually</a>
    </li>
    <li>
      <a href="../articles/Sampling-cross.html">ISTP sampling for cross-sectional studies data</a>
    </li>
    <li>
      <a href="../articles/Sampling-pigeons.html">Sampling with Pigeons.jl</a>
    </li>
    <li>
      <a href="../articles/Sampling-sat.html">ISTP sampling for incomplete multivariate binary data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/serenlee/pimbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Diagnosing the identification of the model</h1>
    <small class="dont-index">Source: <a href="https://github.com/serenlee/pimbayes/blob/HEAD/R/diagnostics.R" class="external-link"><code>R/diagnostics.R</code></a></small>
    <div class="hidden name"><code>diagnose_identification.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate parameters using small posterior samples from JAGS,
calculate the approximate Fisher information matrix
and return the condition number and rank of the approximate Fisher information matrix
with asymptotic variances of estimated parameters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">diagnose_identification</span><span class="op">(</span><span class="va">jags_code</span>, <span class="va">data</span>, <span class="va">variable.names</span>, <span class="va">ll_fun</span>, <span class="va">data_fun</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-jags-code">jags_code<a class="anchor" aria-label="anchor" href="#arg-jags-code"></a></dt>
<dd><p>string. JAGS model code</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>list. Data list of either vector or number</p></dd>


<dt id="arg-variable-names">variable.names<a class="anchor" aria-label="anchor" href="#arg-variable-names"></a></dt>
<dd><p>vector of string. Names of the variables</p></dd>


<dt id="arg-ll-fun">ll_fun<a class="anchor" aria-label="anchor" href="#arg-ll-fun"></a></dt>
<dd><p>function. Log-likelihood function that takes
two arguments - data and theta (parameters)</p></dd>


<dt id="arg-data-fun">data_fun<a class="anchor" aria-label="anchor" href="#arg-data-fun"></a></dt>
<dd><p>function. Function that generates the dataset
using theta (parameters).
argument of this function is
a list of arguments required for creating the dataset.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>list. A list of the condition number, rank, and asymptotic variances.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ll_cross</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">theta</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">sp</span> <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pi</span> <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pi</span>, <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sp</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">se</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sp</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">sp</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">se</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">se</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="va">sp</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">dmultinom</a></span><span class="op">(</span><span class="va">data</span>, prob <span class="op">=</span> <span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">data_cross</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">args</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">theta</span> <span class="op">=</span> <span class="va">args</span><span class="op">$</span><span class="va">theta</span></span></span>
<span class="r-in"><span>    <span class="va">n</span> <span class="op">=</span> <span class="va">args</span><span class="op">$</span><span class="va">n</span></span></span>
<span class="r-in"><span>    <span class="va">se</span> <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">sp</span> <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">pi</span> <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">pi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pi</span>, <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">eta</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sp</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      <span class="va">se</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sp</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      <span class="va">sp</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">se</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">se</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="va">sp</span><span class="op">*</span><span class="va">pi</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">1</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">jags_code</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"model{</span></span></span>
<span class="r-in"><span><span class="st">y[1:4] ~ dmulti(eta[1:4], n)</span></span></span>
<span class="r-in"><span><span class="st">eta[1:4] &lt;- c(se*pi[1]+(1-sp)*pi[3],</span></span></span>
<span class="r-in"><span><span class="st">se*pi[2]+(1-sp)*pi[4],</span></span></span>
<span class="r-in"><span><span class="st">sp*pi[3]+(1-se)*pi[1],</span></span></span>
<span class="r-in"><span><span class="st">(1-se)*pi[2]+sp*pi[4])</span></span></span>
<span class="r-in"><span><span class="st">pi[1:4] ~ ddirch(c(1,1,1,1))</span></span></span>
<span class="r-in"><span><span class="st">se ~ dbeta(25,3)</span></span></span>
<span class="r-in"><span><span class="st">sp ~ dbeta(30,1.5)</span></span></span>
<span class="r-in"><span><span class="st">}"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">small_cross</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">small_cross</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">small_cross</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">diagnose_identification</span><span class="op">(</span><span class="va">jags_code</span>, <span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"se"</span>,<span class="st">"sp"</span>,<span class="st">"pi[1]"</span>,<span class="st">"pi[2]"</span>,<span class="st">"pi[3]"</span><span class="op">)</span>,<span class="va">ll_cross</span>,<span class="va">data_cross</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $condition_number</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3528.201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.5016237 0.2782333 0.3289914 0.8136337 0.2927017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Seren Lee, Paul Gustafson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

